---
title: '#howto - Installare Anchor CMS su Centos 7 (Nginx o Apache)'
published: 2019-01-07
layout: post
author: Mirko B.
author_github: mirkobrombin
tags:
  - nginx  - apache  - mysql  - centos  - php  - github
---
<p>Spesso si utilizza un CMS per abitudine o perchè è migliore di altri per detto dire di altra gente. <strong>Anchor CMS</strong> è una piattaforma di blogging facile da installare, versatile nell'uso ed estremamente leggera, siccome per nulla esoso di risorse.</p><p>Anchor CMS è scritto in php e trova il consenso&nbsp;in chi cerca qualcosa di semplice ma potente per il proprio sito web.</p><p>In questa guida andiamo a vedere come è possibile installare Anchor CMS in <strong>Centos 7 </strong>con <strong>Nginx</strong> o <strong>Apache</strong>.</p><h2>Requisiti</h2><p>Per prima cosa dobbiamo accertarci di soddisfare i requisiti per l'installazione. Ecco di seguito la lista direttamente dalla documentazione ufficiale di Anchor CMS:</p><ul>	<li>Un Web server (Nginx o Apache)</li>	<li>PHP 5.6 o maggiore	<ul>		<li>curl</li>		<li>mcrypt</li>		<li>gd</li>		<li>php-mbstring</li>		<li>pdo_mysql o pdo_sqlite</li>	</ul>	</li>	<li>Un Database server MySQL (MySQL o MariaDB)</li></ul><blockquote><p>Anchor CMS offre una documentazione completa ed esaustiva, una volta terminata la nostra guida vi consiglio di proseguire la lettura dei testi ufficiali.</p><p><a href="http://docs.anchorcms.com/">Documentazione ufficiale</a></p></blockquote><h2 id="title1">Installazione di php-fpm</h2><p>Come dicevamo, Anchor CMS è scritto prevalentemente in php, quindi uno dei requisiti fondamentali. Per&nbsp;questa guida ho scelto php-fpm, un interprete particolarmente&nbsp;veloce e pronto all'uso. Procediamo quindi all'installazione come da prassi:</p><pre><code>sudo yum install php php-fpm</code></pre><p>Procediamo poi con l'installazione di alcuni moduli che estendono la compatibilità di php:</p><pre><code>sudo yum install php-gd php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-snmp php-soap curl curl-devel php-mysql php-opcache</code></pre><p>Infine avviamo il processo ed abilitiamo l'auto esecuzione all'avvio del server:</p><pre><code>sudo systemctl start php-fpmsudo systemctl enable php-fpm</code></pre><h2>Configurazione dominio</h2><p>Il dominio sarà la maschera d'accesso (la base del link)&nbsp;da cui vogliamo raggiungere la nostra installazione. Un esempio è proprio questo sito web, raggiungibile appunto da: linuxhub.it.</p><p>Una volta scelto e acquistato il nostro dominio, procediamo con la configurazione dei DNS.</p><p>Per una miglior&nbsp;fruibilità dei contenuti, la guida su come&nbsp;<strong>puntare un dominio ad un IP</strong>&nbsp;è disponibile&nbsp;<a href="https://linuxhub.it/article/howto-puntare-un-dominio-ad-un-ip">a questo link</a>.</p><h2 id="title4">Preparazione Web server</h2><p>Questa sezione della guida si suddivide in due parti, ossia la configurazione di un Web server (Nginx o Apache, in base alla vostra scelta).</p><p>Di seguito sono riportate le guide su come installare uno&nbsp;due Web server (Nginx e Apache). Una volta scelto seguite l'installazione con la guida&nbsp;appropriata, infine procedete con la sezione:&nbsp;<strong>Configurazione Web server.</strong></p><h3 id="title5">Installazione Nginx</h3><p>Fra le scelte questa è per me la migliore. Se lo scopo del nostro sito web è quello dei grandi numeri in termini di traffico, Nginx è in grado di gestire con facilità grossi carichi, inoltre&nbsp;la sua struttura asincrona gli permette di gestire più eficientemente richieste multiple, occupando la RAM per meno tempo rispetto Apache.</p><p>Per una miglior&nbsp;fruibilità dei contenuti, la guida su come installare&nbsp;<strong>Nginx</strong>&nbsp;su Centos 7 è disponibile&nbsp;<a href="https://linuxhub.it/article/howto-installare-nginx-su-centos-7">a questo link</a>.</p><h3 id="title6">Installazione Apache</h3><p>Per una miglior&nbsp;fruibilità dei contenuti, la guida su come installare&nbsp;<strong>Apache</strong>&nbsp;su Centos 7 è disponibile&nbsp;<a href="https://linuxhub.it/article/howto-installare-apache-su-centos-7">a questo link</a>.</p><h2 id="title7">Configurazione Web server</h2><p>Una volta installato il Web server, possiamo procedere con lo step successivo, la configurazione.</p><h3 id="title8">Configurazione Nginx</h3><p>Per prima cosa creiamo&nbsp;una locazione per i file di installazione:</p><pre><code>mkdir -p /usr/share/nginx/il_mio_dominio_ex</code></pre><p>dove&nbsp;<strong>il_mio_dominio_ex</strong>&nbsp;è il nome del nostro dominio. Non è indispensabile che il nome della cartella ed il dominio siano uguali ma lo consiglio per una migliore gestione.</p><p>Procediamo con la configurazione dei permessi:</p><pre><code>chowh nginx:nginx /usr/share/nginx/il_mio_domionio_exchmod 775 /usr/share/nginx/il_mio_domionio_ex</code></pre><p>In questa fase andiamo a creare un blocco&nbsp;<strong>server</strong>&nbsp;su Nginx per la nostra installazione di Anchor CMS. Portiamoci alla locazione&nbsp;<strong>/etc/nginx/conf.d/default.conf</strong>&nbsp;e cerchiamo la sezione <strong>server{</strong>..<strong>}</strong>&nbsp;predefinita. Una volta indentificata aggiungiamo subito sotto la nostra come di seguito:</p><pre><code>server {    listen       80;    server_name  il_mio_dominio.ex www.il_mio_dominio.ex;    root   /usr/share/nginx/il_mio_dominio_ex;    index index.php index.html index.htm;    location / {        try_files $uri $uri/ =404;    }    error_page 404 /404.html;    error_page 500 502 503 504 /50x.html;    location = /50x.html {        root /usr/share/nginx/html;    }    location ~ \.php$ {        try_files $uri =404;        fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;        fastcgi_index index.php;        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;        include fastcgi_params;    }}</code></pre><p>dove:</p><ul>	<li><strong>il_mio_dominio.ex</strong>&nbsp;- è ovviamente il dominio in nostro possesso che vogliamo dedicare al nuovo sito web</li>	<li><strong>/usr/share/nginx/html/il_mio_dominio_ex</strong>&nbsp;- è il percorso creato precedentemente dove andremo a posizionare i file di installazione</li></ul><p>Procediamo con la modifica di alcune impostazioni di php-fpm necessarie con Nginx. Andiamo ad aprire il file di configurazione nella locazione&nbsp;<strong>/etc/php-fpm.d/www.conf</strong>, cerchiamo la voce&nbsp;<strong>listen</strong>&nbsp;e modifichiamo come di seguito:</p><pre><code>listen = /var/run/php-fpm/php-fpm.sock</code></pre><p>portiamoci poi alle voci&nbsp;<strong>listen.owner</strong>&nbsp;e&nbsp;<strong>listen.group</strong>&nbsp;rendendole:</p><pre><code>listen.owner = nobodylisten.group = nobody</code></pre><p>infine cerchiamo&nbsp;le voci&nbsp;<strong>user</strong>&nbsp;e&nbsp;<strong>group</strong>&nbsp;ed adattiamole come di seguito:</p><pre><code>user = nginxgroup = nginx</code></pre><p>Non ci resta che riavviare i processi:</p><pre><code>sudo systemctl restart php-fpm nginx</code></pre><h3 id="title9">Configurazione Apache</h3><p>Creiamo ora una posizione da usare successivamente nell'installazione. Creiamo la directory:</p><pre><code>mkdir -p /var/www/il_mio_dominio_ex</code></pre><p>dove&nbsp;<strong>il_mio_dominio_ex</strong>&nbsp;è il nome del nostro dominio. Non è indispensabile che il nome della cartella e quello del dominio siano uguali ma lo consiglio per una migliore gestione.</p><p>Impostiamo i permessi alla nuova locazione:</p><pre><code>chowh apache:apache /var/www/il_mio_domionio_exchmod 775 /var/www/il_mio_domionio_ex</code></pre><p>Andiamo ora a creare la configurazione Apache per il nostro sito web. Creiamo quindi il file alla locazione&nbsp;<strong>/etc/httpd/vhosts.d/il_mio_dominio.ex.conf</strong>&nbsp;(dove il_mio_dominio.ex è il nome del dominio da cui faremo accesso al sito web) col seguente contenuto:</p><pre><code>&lt;VirtualHost localhost:80&gt;ServerAdmin admin@il_mio_dominio.exDocumentRoot "/var/www/html/il_mio_dominio_ex/"ServerName il_mio_dominio.exServerAlias www.il_mio_dominio.exErrorLog "/var/log/httpd/il_mio_dominio.ex-error_log"CustomLog "/var/log/httpd/il_mio_dominio.ex-access_log" combined&lt;Directory "/var/www/html/il_mio_dominio_ex/"&gt;DirectoryIndex index.html index.phpOptions FollowSymLinksAllowOverride AllRequire all granted&lt;/Directory&gt;&lt;/VirtualHost&gt;</code></pre><p>dove:</p><ul>	<li><strong>il_mio_dominio.ex</strong>&nbsp;- è ovviamente il dominio in nostro possesso che vogliamo dedicare al nuovo sito web</li>	<li><strong>/usr/share/nginx/html/il_mio_dominio_ex</strong>&nbsp;- è il percorso creato precedentemente</li></ul><p>Andiamo ora a modificare alcune configurazioni per istruire Apache ad usare php-fpm per la gestione delle richieste php. Creiamo un nuovo file di configurazione alla locazione&nbsp;<strong>/etc/httpd/conf.d/php.conf</strong>&nbsp;col seguente contenuto:</p><pre><code>&lt;Proxy "unix:/var/run/php-fpm/default.sock|fcgi://php-fpm"&gt;    	ProxySet disablereuse=off&lt;/Proxy&gt;&lt;FilesMatch \.php$&gt;	SetHandler proxy:fcgi://php-fpm&lt;/FilesMatch&gt;## Allow php to handle Multiviews#AddType text/html .php## Add index.php to the list of files that will be served as directory# indexes.#DirectoryIndex index.php</code></pre><p>Portiamoci al file&nbsp;<strong>/etc/php-fpm.d/www.conf</strong>&nbsp;e cerchiamo la voce&nbsp;<strong>listen</strong>&nbsp;modificandola come di seguito:</p><pre><code>listen = /var/run/php-fpm/default.sock</code></pre><p>modifichiamo poi le seguenti voci:</p><pre><code>listen.owner = apachelisten.group = apachelisten.mode = 0660user = apachegroup = apache</code></pre><p>Riavviamo infine i processi con:</p><pre><code>systemctl restart php-fpm httpd</code></pre><h2>Installazione e configurazione di MariaDB</h2><p>Procediamo ora con l'installazione del Database server, ossia&nbsp;di&nbsp;<strong>mariadb</strong>&nbsp;e&nbsp;<strong>mariadb-server</strong>:</p><pre><code>sudo yum install mariadb-server mariadb</code></pre><p>ed avviamo poi il processo con&nbsp;<strong>systemctl</strong>:</p><pre><code>sudo systemctl start mariadb</code></pre><p>Per quanto riguarda la configurazione, viene in nostro soccorso il wizard mysql, una installazione guidata di mysql, digitiamo quindi:</p><pre><code>sudo mysql_secure_installation</code></pre><p>e seguiamo le istruzioni a schermo, ricordando di annotare la&nbsp;<strong>password</strong>&nbsp;una volta fornita poichè ci servirà nella fase di installazione.</p><blockquote><p>Di seguito le scelte che consiglio nella fase di installazione guidata di mysql:</p><ul>	<li>Set root password? Si</li>	<li>Remove&nbsp;anonymous users? Si</li>	<li>Disallow root login remotely? Si</li></ul></blockquote><h3>Creazione del database</h3><p>In questa sezione andiamo a creare un database che useremo poi in fase di installazione di Anchor CMS.</p><p>Facciamo accesso alla&nbsp;<strong>console</strong>&nbsp;<strong>mysql</strong>&nbsp;digitando&nbsp;quindi:</p><pre><code>mysql -u root -p</code></pre><p>ci verrà chiesta la password inserita in fase di configurazione di mysql, inseriamola e creiamo il nuovo database:</p><pre><code>CREATE DATABASE il_mio_dominio;</code></pre><p>dove&nbsp;<strong>il_mio_dominio</strong>&nbsp;sarà il nome del database. Creiamo ora l'utente, digitiamo la query:</p><pre><code>CREATE USER il_mio_user@localhost IDENTIFIED BY 'la_mia_password';</code></pre><p>dove:</p><ul>	<li>il_mio_user - è il nome utente con cui faremo accesso al database</li>	<li>la_mia_password - è la password del nostro utente</li></ul><p>diamo ora i permessi di accesso al nostro utente con la seguente query:</p><pre><code>GRANT ALL PRIVILEGES ON il_mio_dominio.* TO il_mio_user@localhost;FLUSH PRIVILEGES;</code></pre><p>chiudiamo infine la console:</p><pre><code>exit</code></pre><h2>Installazione di Anchor CMS:</h2><p>Eccoci alla fase finale, la vera e propria installazione di Anchor CMS.</p><p>Per questa fase utilizzeremo&nbsp;<strong>git</strong>&nbsp;per clonare i file di installazione dalla repository GitHub di Anchor CMS. Otteniamo quindi una copia dei file di installazione:</p><pre><code>cd /il_mio_dominio_exgit clone https://github.com/anchorcms/anchor-cms.gitmv /il_mio_dominio_ex/anchor-cms/* /il_mio_dominio_ex/</code></pre><p>dove:&nbsp;<strong>/il_mio_dominio_ex</strong>&nbsp;è la directory&nbsp;che abbiamo precedentemente configurato per la nostra installazione.</p><p>Impostiamo&nbsp;i permessi per <strong>content</strong>&nbsp;e&nbsp;<strong>admin/config</strong>:</p><pre><code>chmod -R 775 content admin/config</code></pre><p>Visitiamo ora il nostro dominio e proseguiamo con l'installazione guidata da browser.</p><p><em>Good&nbsp;<strong>*nix</strong>?</em><br /><em>&nbsp;- Mirko</em></p>