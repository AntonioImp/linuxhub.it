---
title: "#howto - Cambiare la porta SSH e disabilitare l'accesso via root su Centos"
published: 2019-01-13
layout: post
author: Mirko B.
author_github: mirkobrombin
tags:
  - debian  
  - ubuntu  
  - centos  
  - fedora  
  - ssh
---
<p>L'utente&nbsp;<strong>root</strong>&nbsp;viene spesso utilizzato come principale per ogni scopo e operazione. Possiamo intendere l'user root come un superadmin, colui che ha accesso ad ogni angolo del sistema e che quindi, come tale, può arrecare seri danni se usato inconsciamente.</p><p>Una delle principali procedure messe in atto da un amministratore di sistemi è quella di disabilitare l'accesso root via ssh.</p><p>Seguire questa semplice procedura ci permette di proteggere il nostro server da possibili accessi malevoli. Basti pensare alla marea di bot online che ogni minuto tentano l'accesso via SSH ad un qualsiasi server. Nel caso uno di questi bot o un qualsiasi utente intenzionato, dovesse avere accesso root, avrà a disposizione letteralmente a tutti i vostri dati, senza eccezione. Per ovviare completamente a questo problema, esistono in realtà metodi migliori, come&nbsp;la disabilitazione dell'accesso via password e l'<a href="https://linuxhub.it/article/howto-autenticazione-chiave-ssh-su-server-centosfedoradebianubuntu-e-derivate">abilitazione del login via chiave SSH</a> (che approfondiremo in un'altra guida) ed il cambio della porta SSH di cui parleremo in fondo questa guida.</p><p>Procediamo quindi alla disabilitazione dell'account root via SSH.</p><h2>Creazione di un nuovo utente</h2><p>Prima di tutto dobbiamo creare un nuovo utente che useremo per accedere&nbsp;una volta disabilitato il RootLogin:</p><pre><code>adduser operator</code></pre><p>dove&nbsp;<strong>operator</strong>&nbsp;è l'username del nostro nuovo utente. Impostiamo ora una password:</p><pre><code>passwd operator</code></pre><p>ed aggiungiamo l'utente al gruppo wheel:</p><pre><code>usermod -aG wheel operator</code></pre><p>in questo modo avremo accesso ai privilegi sudo.</p><blockquote><p>I privilegi sudo non sostituiscono una figura superadmin completa, non hanno accesso completo al sistema e non possono eliminare e/o modificare contenuti di proprietà root.</p></blockquote><h2>Disabilitazione RootLogin</h2><p>Per disabilitare l'accesso via root dobbiamo modificare la configurazione di&nbsp;<strong>sshd</strong>, modifichiamo il file in locazione&nbsp;<strong>/etc/ssh/sshd_config</strong>&nbsp;modificando il parametro che segue:</p><pre><code>..PermitRootLogin no..</code></pre><p>riavviamo infine il processo con&nbsp;<strong>systemctl</strong>:</p><pre><code>systemctl restart sshd</code></pre><p>Possiamo ora effettuare il logout da root ed accedere col nostro nuovo utente&nbsp;<strong>operator</strong>.</p><h2>Cambiare porta SSH</h2><p>Una delle migliori pratiche da applicare subito dopo la disabilitazione dell'account root, è quella di cambiare la porta SSH, in modo da rendere più difficile il suo raggiungimento.</p><p>Come per la RootLogin, anche la porta viene definita nel file di configurazione di&nbsp;<strong>sshd</strong>, apriamo quindi la configurazione in&nbsp;<strong>/etc/ssh/sshd_config</strong>&nbsp;e modifichiamo i parametri come segue:</p><pre><code>Port 2234</code></pre><p>dove&nbsp;<strong>2234</strong>&nbsp;è la nuova porta da cui vogliamo fare accesso via SSH.</p><p>Prima di procedere col riavvio, assicuriamoci l'apertura della porta via firewall:</p><pre><code>sudo firewall-cmd --permanent --zone=public --add-port=2234/tcp</code></pre><p>ed istruiamo SELinux:</p><pre><code>sudo semanage port -a -t ssh_port_t -p tcp 2234</code></pre><p>Riavviamo infine firewall e sshd:</p><pre><code>sudo firewall-cmd --reloadsudo systemctl restart sshd</code></pre><p>Effettuiamo il logout e colleghiamoci via SSH alla nuova porta.</p><p><em>Good&nbsp;<strong>*nix</strong>?</em><br /><em>&nbsp;- Mirko</em></p>